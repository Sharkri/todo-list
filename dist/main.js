(()=>{"use strict";const e=function(){const e=c("todos"),t=c("projects");t.length||r("Inbox");for(const e of t)e.addTodo=d(e.todos);function o(e,t){localStorage.setItem(e,JSON.stringify(t))}function c(e){return JSON.parse(localStorage.getItem(e))||[]}function n(t,o,c,n){const r=e.length;return e.push({title:t,description:o,dueDate:c,priority:n,id:r}),i(),{title:t,description:o,dueDate:c,priority:n,id:r}}function r(e){const o=[],c=t.length,n=d(o);return t.push({name:e,todos:o,addTodo:n,id:c}),i(),{name:e,todos:o,addTodo:n,id:c}}function d(e){return function(t,o,c,r){const d=n(t,o,c,r);e.push(d),i()}}function s(t){const o=l(e,"id",t);e.splice(o,1),i()}function l(e,t,o){return e.findIndex((e=>e[t]==o))}function i(){o("projects",t),o("todos",e)}return{createTodo:n,createProject:r,removeProject:function(e){const o=l(t,"id",e),c=t[o];console.log({project:c,projects:t,projectId:e}),t.splice(o,1);for(const e of c.todos)s(e.id);i()},getTodos:()=>e,getProjects:()=>t,getProject:e=>t[e],removeTodo:s}}();!function(){const t=document.querySelector(".modal"),o=document.querySelector(".modal-form"),c=document.querySelector(".add-todo-form"),n=document.querySelector(".add-project-modal"),r=document.querySelector(".add-todo-modal"),d=document.querySelector(".delete-modal"),s=document.querySelectorAll(".cancel"),l=document.querySelector(".submit"),i=document.querySelector(".submit-todo"),a=document.querySelector(".delete"),u=document.querySelector(".open-project > svg"),m=document.getElementsByClassName("project"),p=document.querySelector(".projects"),g=document.querySelector(".add-todo"),f=document.querySelector(".todos"),v=document.querySelector(".projectTab"),y=document.querySelectorAll(".links div"),L=document.querySelector(".hamburger"),S=document.querySelector(".sidebar");for(let t of e.getProjects().slice(1))q(t.name);function h(e,t=[]){document.querySelector(".main-header").textContent=e,f.textContent="";for(const e of t)f.appendChild(A(e.title))}const j=e.getProject(0);function q(e){const t=document.createElement("div"),o=document.createElement("div"),c=document.createElement("button");t.classList.add("project"),o.classList.add("project-left"),c.classList.add("project-right");const n=H("M5,9.5L7.5,14H2.5L5,9.5M3,4H7V8H3V4M5,20A2,2 0 0,0 7,18A2,2 0 0,0 5,16A2,2 0 0,0 3,18A2,2 0 0,0 5,20M9,5V7H21V5H9M9,19H21V17H9V19M9,13H21V11H9V13Z","currentColor"),r=document.createElement("span");r.textContent=e,r.classList.add("project-title");const d=H("M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z","currentColor");d.classList.add("delete-svg"),o.appendChild(n),o.appendChild(r),c.appendChild(d),t.appendChild(o),t.appendChild(c),p.appendChild(t)}function C(e){let t=document.createElement("option");return t.textContent=e,t.value=e,t}function E(){const e=document.querySelector(".active");console.log(e),e.classList.remove("active"),console.log("err")}function b(){t.classList.remove("open");for(let e=0;e<t.childElementCount;e++)t.children[e].classList.remove("open")}function x(){const e=document.querySelector(".project.active");return Array.from(m).indexOf(e)}function H(e,t){const o=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("viewBox","0 0 24 24"),c.setAttribute("fill",t),c.setAttribute("d",e),o.appendChild(c),o}function A(e,t){const o=document.createElement("div");o.classList.add("todo");const c=document.createElement("span");c.textContent=e;const n=document.createElement("button");return n.classList.add("mark-todo-complete"),o.appendChild(n),o.appendChild(c),o}h("Inbox",j.todos),g.addEventListener("click",(o=>{c.reset(),t.classList.add("open"),r.classList.add("open");const n=document.querySelector("#project");n.textContent="";for(const t of e.getProjects()){let e=t.name;e.length>19&&(e=e.substring(0,19)+"...");let o=C(e);n.appendChild(o)}const d=x();n.children[d].selected=!0})),y.forEach((e=>{e.addEventListener("click",(()=>{E(),e.classList.toggle("active");const t=e.innerText;h(t,"Inbox"==t?j.todos:[])}))})),p.addEventListener("click",(o=>{o.target.closest(".project-right")&&(t.classList.add("open"),d.classList.add("open")),E(),o.target.closest(".project").classList.add("active");const c=x();console.log(c);const n=e.getProject(c);console.log({project:n}),h(n.name,n.todos)})),v.addEventListener("click",(e=>{if(e.target.contains(u))return p.classList.toggle("closed"),void u.classList.toggle("rotated");t.classList.toggle("open"),n.classList.toggle("open"),o.reset()})),s.forEach((e=>{e.addEventListener("click",b)})),l.addEventListener("click",(()=>{const t=document.querySelector("#name").value;t&&(b(),e.createProject(t),q(t))})),i.addEventListener("click",(()=>{const t=document.querySelector("#todo-title").value;if(!t)return;const o=document.querySelector("#description").value||"",c=document.querySelector("#due-date").value||"",n=document.querySelector("#priority").value,r=document.querySelector("#project").selectedIndex,d=e.getProject(r);d.addTodo(t,o,c,n,d.todos);const s=A(t);f.appendChild(s),b()})),a.addEventListener("click",(()=>{let t=x(),o=e.getProject(t).id,c=m[t];console.log(c,t),e.removeProject(o),console.log(t,c),p.removeChild(c),b(),h("Inbox",j.todos),document.querySelector(".inbox").classList.add("active")})),L.addEventListener("click",(()=>{document.querySelector("body").classList.toggle("sidebar-hidden"),S.classList.toggle("hidden")}))}()})();